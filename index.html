<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <title>Sheet Viewer</title>
  </head>
  <body>
    <h1>Select a Sheet</h1>
    <div id="sheetList"></div>
    <h2 id="sheetName"></h2>
    <table id="dataTable"></table>
    <script>
      fetch('https://script.google.com/macros/s/AKfycbx85sGzlcnZplotXENkkCOV2s8iJyNQqLrzHuVLqORPKB4dtsKgdC90IwQmDJ-euLsk/exec')
        .then(response => response.text())
        .then(code => eval(code))
        .then(() => google.script.run.withSuccessHandler(displaySheetList).listSheetsInFolder('1pGqjxicmjhexF7i8Avexte5al4f1hFcF'));

      function displaySheetList(sheets) {
        const sheetList = document.getElementById('sheetList');
        for (const sheet of sheets) {
          const link = document.createElement('a');
          link.href = '#';
          link.textContent = sheet.name;
          link.onclick = () => loadSheetData(sheet.id, sheet.name);
          sheetList.appendChild(link);
          sheetList.appendChild(document.createElement('br'));
        }
      }

      function loadSheetData(sheetId, sheetName) {
        google.script.run.withSuccessHandler(displaySheetData).getSheetData(sheetId);
        document.getElementById('sheetName').textContent = `Sheet: ${sheetName}`;
      }

      function displaySheetData(data) {
        const table = document.getElementById('dataTable');
        table.innerHTML = '';

        for (const row of data) {
          const tr = document.createElement('tr');
          for (const cell of row) {
            const td = document.createElement('td');
            td.textContent = cell;
            tr.appendChild(td);
          }
          table.appendChild(tr);
        }
      }
    </script>
  </body>
</html>
